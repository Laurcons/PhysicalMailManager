(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{75:function(e,t,n){"use strict";n.r(t);var i=n(1),a=n.n(i),r=n(17),c=n.n(r),s=n(7),l=n(9),o=n(41),d=n.n(o).a.create({baseURL:"http://localhost:822/api/",withCredentials:!0}),j=n(0);function b(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(""),l=Object(s.a)(c,2),o=l[0],b=l[1],u=Object(i.useState)(!1),h=Object(s.a)(u,2),O=h[0],m=h[1],p=Object(i.useState)(null),x=Object(s.a)(p,2),f=x[0],g=x[1];return Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),console.log("called!");var n=new FormData;n.append("username",a),n.append("password",o),m(!0),g(null),d.post("/login",n).then((function(){d.get("/user").then((function(t){e.onLogin(t.data.data)}))})).catch((function(e){var t,n;switch(null===(t=e.response)||void 0===t?void 0:t.data.status){case"user-not-found":g("Utilizatorul nu a fost g\u0103sit!");break;case"password-invalid":g("Parola dvs. este incorect\u0103!");break;default:g("A avut loc o eroare necunoscut\u0103: "+(null===(n=e.response)||void 0===n?void 0:n.data.status))}})).finally((function(){m(!1)}))},style:{maxWidth:"480px"},children:[Object(j.jsx)("h2",{children:"Autentificare"}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Nume utilizator:"}),Object(j.jsx)("input",{className:"form-control",type:"text",onChange:function(e){r(e.target.value)}})]}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Parola:"}),Object(j.jsx)("input",{className:"form-control",type:"password",onChange:function(e){b(e.target.value)}})]}),f&&Object(j.jsx)("div",{className:"alert alert-danger",children:f}),Object(j.jsxs)("button",{className:"btn btn-primary",type:"submit",children:["Autentificare",O&&Object(j.jsx)("span",{className:"spinner-border-sm spinner-border border-secondary ml-2"})]}),Object(j.jsx)("button",{className:"btn btn-secondary",onClick:e.onPageSwitch,children:"\xcenregistrare"})]})}var u=n(42);function h(e){var t=Object(i.useState)(""),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(""),l=Object(s.a)(c,2),o=l[0],b=l[1],h=Object(i.useState)(""),O=Object(s.a)(h,2),m=O[0],p=O[1],x=Object(i.useState)(null),f=Object(s.a)(x,2),g=f[0],v=f[1],N=Object(i.useState)(null),y=Object(s.a)(N,2),_=y[0],S=y[1],T=Object(i.useState)(!1),I=Object(s.a)(T,2),E=I[0],P=I[1];return Object(j.jsxs)("form",{onSubmit:function(e){if(e.preventDefault(),o!==m)return void v("Parolele nu coincid!");if(0===o.trim().length||0===a.trim().length)return void v("A\u021bi l\u0103sat unul dintre c\xe2mpuri liber!");var t=new FormData;t.append("username",a),t.append("password",o),P(!0),d.post("/register",t).then((function(e){P(!1),S("Te-ai \xeenregistrat cu succes! Mergi spre autentificare.")})).catch((function(e){var t,n=null===(t=e.response)||void 0===t?void 0:t.data.status;v("username-not-unique"===n?"Numele de utilizator exist\u0103 deja! Alege\u021bi altul.":"A avut loc o eroare necunoscut\u0103.")}))},style:{maxWidth:"480px"},children:[Object(j.jsx)("h2",{children:"\xcenregistrare"}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Nume utilizator:"}),Object(j.jsx)("input",{className:"form-control",type:"text",onChange:function(e){r(e.target.value)}})]}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Parola:"}),Object(j.jsx)("input",{className:"form-control",type:"password",onChange:function(e){b(e.target.value)}})]}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Confirm\u0103 parola:"}),Object(j.jsx)("input",{className:"form-control",type:"password",onChange:function(e){p(e.target.value)}})]}),g&&Object(j.jsx)("div",{className:"alert alert-danger",children:g}),_&&Object(j.jsx)("div",{className:"alert alert-success",children:_}),Object(j.jsxs)("button",{className:"btn btn-primary",type:"submit",children:["\xcenregistrare",E&&Object(j.jsx)(u.a,{animation:"border",size:"sm",variant:"secondary",className:"ml-2"})]}),Object(j.jsx)("button",{className:"btn btn-secondary",onClick:e.onPageSwitch,children:"Autentificare"})]})}var O=n(3),m=n.n(O),p=n(79),x=n(6),f=n(18),g=n(8),v=n(22),N=n(21),y=n.n(N);function _(e){var t=[],n=[];return e.street&&n.push("Str. ".concat(e.street)),e.number&&n.push("Nr. ".concat(e.number)),t.push(n),n=[],e.block&&n.push("Bloc ".concat(e.block)),e.stair&&n.push("Scara ".concat(e.stair)),e.apartment&&n.push("Ap. ".concat(e.apartment)),t.push(n),n=[],e.locality&&e.commune&&n.push("Sat ".concat(e.locality)),e.locality&&!e.commune&&n.push("Ora\u0219 ".concat(e.locality)),e.commune&&n.push("Com. ".concat(e.commune)),t.push(n),n=[],e.county&&n.push("Jud. ".concat(e.county)),e.postalCode&&n.push("Cod po\u0219tal ".concat(e.postalCode)),t.push(n),t.filter((function(e){return e.length>0})).map((function(e){return e.join(", ")})).join("\n")}function S(e){var t=new FormData;return Object.keys(e).forEach((function(n){t.append(n,e[n])})),t}function T(e,t){e=encodeURIComponent(e),t=encodeURIComponent(t);for(var n=document.location.search.substr(1).split("&"),i=0;i<n.length;i++)if(n[i].startsWith(e+"=")){var a=n[i].split("=");a[1]=t,n[i]=a.join("=");break}return i>=n.length&&(n[n.length]=[e,t].join("=")),n.join("&")}function I(e){var t,n,i=new URLSearchParams(Object(x.i)().search),a=null!==(t=e.currentPage)&&void 0!==t?t:parseInt(null!==(n=i.get("p"))&&void 0!==n?n:"0");return Object(j.jsx)("nav",{children:Object(j.jsx)("ul",{className:"pagination mb-0 flex-wrap",children:Array(e.pages).fill(0).map((function(e,t){return Object(j.jsx)("li",{className:m()({"page-item":!0,active:t===a}),children:Object(j.jsx)(l.b,{to:"?"+T("p",t.toString()),className:"page-link",children:t+1})},t)}))})})}function E(e){var t=Object(i.useState)(Object.assign({},e.subject)),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(!1),l=Object(s.a)(c,2),o=l[0],d=l[1];function b(t){var n=Object.keys(e.subject).some((function(n){return e.subject[n]!==t[n]}));r(t),d(n),e.onModify&&e.onModify(t,!n)}var u=Object.keys(e.subject).filter((function(t){return e.subject[t]!==a[t]}));return Object(j.jsxs)("div",{className:"card mb-3",children:[Object(j.jsx)("div",{className:"card-header",children:Object(j.jsx)("h5",{className:"card-title",children:"Detalii"})}),Object(j.jsxs)("div",{className:"card-body p-0",children:[e.children,Object(j.jsx)("table",{className:"table table-sm table-bordered mb-0",children:Object(j.jsx)("tbody",{children:Object.keys(a).sort((function(t,n){var i,a;return e.orderTable?(null===(i=e.orderTable)||void 0===i?void 0:i.findIndex((function(e){return e===t})))-(null===(a=e.orderTable)||void 0===a?void 0:a.findIndex((function(e){return e===n}))):0})).map((function(t){var n;return Object.keys(e.translationTable).includes(t)?Object(j.jsxs)("tr",{className:m()({"bg-danger":e.isHighlighted&&u.includes(t)}),children:[Object(j.jsx)("td",{children:e.translationTable[t]}),Object(j.jsx)("td",{children:Object(j.jsx)("input",{className:"form-control form-control-sm",type:"text",value:null!==(n=a[t])&&void 0!==n?n:"",onChange:function(e){!function(e,t){var n=Object.assign({},a);n[e]=t,b(n)}(t,e.target.value)}})})]},t):null}))})})]}),Object(j.jsxs)("div",{className:"card-footer",children:[o&&"Modificat",Object(j.jsxs)("div",{className:"btn-group float-right",children:[Object(j.jsx)("button",{type:"button",className:"btn btn-secondary btn-sm float-right",onClick:function(){b(Object.assign({},e.subject))},children:"Reseteaz\u0103"}),Object(j.jsx)("button",{type:"button",className:"btn btn-primary btn-sm float-right",onClick:function(){e.onSubmit(a)},children:"Salveaz\u0103"})]})]})]})}function P(e,t){switch(t.type){case"SET_LOADING":return Object(g.a)(Object(g.a)({},e),{},{isLoading:t.payload});case"SET_DESTINATIONS":return Object(g.a)(Object(g.a)({},e),{},{destinations:t.payload});case"UPDATE_DESTINATION":var n=Object(f.a)(e.destinations),i=n.findIndex((function(e){return e._id===t.payload._id}));return-1!==i?n[i]=t.payload:n.push(t.payload),Object(g.a)(Object(g.a)({},e),{},{destinations:n});case"REMOVE_DESTINATION":return Object(g.a)(Object(g.a)({},e),{},{destinations:e.destinations.filter((function(e){return e._id!==t.payload}))});case"SET_IS_CURRENT_MODIFIED":return Object(g.a)(Object(g.a)({},e),{},{isCurrentModified:t.payload});case"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED":return Object(g.a)(Object(g.a)({},e),{},{isPropertyEditorHighlighted:t.payload});default:throw new Error("Invalid action")}}var D=function(e){var t,n,a,r=new URLSearchParams(Object(x.i)().search),c=Object(x.h)(),o=Object(i.useReducer)(P,{destinations:[],entriesPerPage:10,isCurrentModified:!1,isPropertyEditorHighlighted:!1,isLoading:!0}),b=Object(s.a)(o,2),u=b[0],h=b[1],O=Math.floor(u.destinations.length/u.entriesPerPage)+(u.destinations.length%u.entriesPerPage!==0?1:0)+(0===u.destinations.length?1:0),p=r.get("toid")?parseInt(null!==(t=r.get("toid"))&&void 0!==t?t:"-1"):null,f=r.get("id")?parseInt(null!==(n=r.get("id"))&&void 0!==n?n:"-1"):p,g=u.destinations.find((function(e){return e._id===f})),N=null===r.get("p")&&null===r.get("toid")||"null"!==r.get("id")&&null!==r.get("p")?parseInt(null!==(a=r.get("p"))&&void 0!==a?a:"0"):Math.floor(u.destinations.findIndex((function(e){return e._id===p}))/u.entriesPerPage);function S(){h({type:"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED",payload:!0}),setTimeout((function(){h({type:"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED",payload:!1})}),250)}return console.log(r.get("id"),N),Object(i.useEffect)((function(){d.get("/destinations").then((function(e){h({type:"SET_DESTINATIONS",payload:e.data.data}),h({type:"SET_LOADING",payload:!1})}))}),[]),u.isLoading?Object(j.jsx)("span",{className:"spinner spinner-border"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(x.a,{when:u.isCurrentModified,message:"Ave\u021bi modific\u0103ri nesalvate! Sunte\u021bi sigur c\u0103 dori\u021bi s\u0103 p\u0103r\u0103si\u021bi pagina?"}),Object(j.jsxs)("div",{className:"row",children:[Object(j.jsxs)("div",{className:g?"col-md-8":"col-12",children:[Object(j.jsxs)("div",{className:"d-flex mb-2",children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)("button",{className:"btn btn-primary",onClick:function(){u.isCurrentModified?S():d.post("/destination").then((function(e){h({type:"UPDATE_DESTINATION",payload:e.data.data})}))},children:"Adaug\u0103 destinatar"})}),Object(j.jsx)("div",{className:"overflow-scroll",children:Object(j.jsx)(I,{pages:O,currentPage:N})})]}),Object(j.jsxs)("table",{className:"table table-bordered table-hover",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Nume"}),Object(j.jsx)("th",{children:"Adresa"}),Object(j.jsx)("th",{children:"Observa\u021bii"})]})}),Object(j.jsx)("tbody",{children:u.destinations.sort((function(e,t){return e.name>t.name?1:-1})).slice(u.entriesPerPage*N,u.entriesPerPage*N+u.entriesPerPage).map((function(e,t){return Object(j.jsxs)("tr",{onClick:function(){return function(e){if(u.isCurrentModified)S();else{var t=e===f?"null":e.toString();c.push("?"+T("id",t))}}(e._id)},className:m()({"table-active":e._id===f&&!u.isCurrentModified,"table-warning":e._id===f&&u.isCurrentModified}),style:{cursor:"pointer"},children:[Object(j.jsxs)("td",{children:[Object(j.jsx)("span",{className:"badge badge-danger",children:N*u.entriesPerPage+t+1}),Object(j.jsx)("span",{className:"badge badge-info",children:e._id}),"\xa0",e.name]},e.name),Object(j.jsx)("td",{children:_(e).split("\n").map((function(e){return Object(j.jsxs)(j.Fragment,{children:[e,Object(j.jsx)("br",{})]})}))},t+"-1"),Object(j.jsx)("td",{children:e.observations},t+"-2")]},y()(e))}))})]}),Object(j.jsx)("div",{className:"overflow-scroll",children:Object(j.jsx)(I,{pages:O,currentPage:N})})]}),Object(j.jsx)("div",{className:"col",children:g&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"card mb-2",children:[Object(j.jsx)("div",{className:"card-header",children:Object(j.jsx)("h5",{className:"card-title",children:"Op\u021biuni"})}),Object(j.jsxs)("div",{className:"card-body d-flex flex-column",children:[Object(j.jsx)(l.b,{className:"btn btn-primary btn-sm mb-2",to:"/letters/group?id="+g._id,children:"Toate scrisorile destinatarului"}),Object(j.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:function(){if(window.confirm("Sunte\u021bi sigur c\u0103 dori\u021bi s\u0103 \u0219terge\u021bi acest destinatar?\n"+(null===g||void 0===g?void 0:g.name))){var e=new FormData;e.append("_method","delete"),d.post("/destination/".concat(null===g||void 0===g?void 0:g._id),e).then((function(e){var t;h({type:"REMOVE_DESTINATION",payload:null!==(t=null===g||void 0===g?void 0:g._id)&&void 0!==t?t:-1})}))}},children:"\u0218terge destinatar"})]})]}),Object(j.jsx)(E,{subject:null!==g&&void 0!==g?g:{},onSubmit:function(e){var t,n=new FormData,i=Object.keys(null!==g&&void 0!==g?g:{}).filter((function(t){return g[t]!==e[t]})),a=Object(v.a)(i);try{for(a.s();!(t=a.n()).done;){var r,c=t.value;n.append(c,null!==(r=e[c])&&void 0!==r?r:"")}}catch(s){a.e(s)}finally{a.f()}n.append("_method","patch"),d.post("/destination/".concat(e._id),n).then((function(t){h({type:"UPDATE_DESTINATION",payload:e}),h({type:"SET_IS_CURRENT_MODIFIED",payload:!1})}))},onModify:function(e,t){h({type:"SET_IS_CURRENT_MODIFIED",payload:!t})},isHighlighted:u.isPropertyEditorHighlighted,translationTable:{name:"Nume",street:"Strada",number:"Num\u0103rul",block:"Bloc",stair:"Scara",apartment:"Apartament",locality:"Localitate",commune:"Comuna",county:"Jude\u021bul",postalCode:"Cod po\u0219tal",observations:"Observa\u021bii"},orderTable:["name","street","number","block","stair","apartment","locality","commune","county","postalCode","observations"]},y()(g))]})})]})]})},w=n(77);var C=function(e){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)("p",{children:"Bine a\u021bi venit \xeen Managerul de Po\u0219t\u0103 Fizic\u0103!"}),Object(j.jsx)("p",{children:"Acesta reprezint\u0103 proiectul lui Pricop Lauren\u021biu pentru Atestatul de sf\xe2r\u0219it de clasa a XII-a. \xcens\u0103, am dorit s\u0103 fac aceast\u0103 aplica\u021bie capabil\u0103 de a fi hostat\u0103 public, \u0219i probabil va primi actualiz\u0103ri de-a lungul timpului!"}),Object(j.jsx)("p",{children:"Versiunea aplica\u021biei: v1.0"}),Object(j.jsx)(w.a,{variant:"secondary",onClick:function(){d.post("/logout").then((function(){e.onLogout("user-initiated")}))},children:"Deautentificare"})]})};function A(e){var t,n=Object(x.i)(),i=new URLSearchParams(n.search),a=i.get("id")?parseInt(null!==(t=i.get("id"))&&void 0!==t?t:"0"):null;return Object(j.jsx)(j.Fragment,{children:e.destinations.filter((function(t){return e.letters.map((function(e){return e.destinationId})).includes(t._id)})).sort((function(e,t){return e.name>t.name?1:-1})).map((function(t,n){var i=e.letters.filter((function(e){return e.destinationId===t._id})),r=i.filter((function(e){return"incoming"===e.type})),c=i.filter((function(e){return"outgoing"===e.type}));return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("div",{className:"card mb-3",children:[Object(j.jsxs)("div",{className:"card-header position-relative",children:[Object(j.jsxs)("h5",{className:"card-title d-inline",id:"id_"+t._id,children:[Object(j.jsx)("span",{className:"badge badge-danger",children:n+1}),Object(j.jsx)("span",{className:"badge badge-info mr-2",children:t._id}),t.name,Object(j.jsxs)("span",{className:"badge badge-info ml-2",children:[i.length," scrisori"]})]}),a===t._id?Object(j.jsx)(l.b,{className:"btn btn-primary float-right stretched-link",to:"?id=null",children:"Ascunde"}):Object(j.jsx)(l.b,{className:"btn btn-primary float-right stretched-link",to:"?id="+t._id,children:"Arat\u0103"})]}),a===t._id&&Object(j.jsx)("div",{className:"card-body",children:Object(j.jsxs)("div",{className:"row",children:[Object(j.jsxs)("div",{className:"col-md",children:[Object(j.jsx)("h5",{children:"Primite"}),Object(j.jsxs)("table",{className:"table table-striped table-bordered table-hover table-sm table-responsive-md",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Cod"}),Object(j.jsx)("th",{children:"Primit\u0103 la"}),Object(j.jsx)("th",{children:"De m\xe2n\u0103?"}),Object(j.jsx)("th",{children:"Observa\u021bii"})]})}),Object(j.jsxs)("tbody",{children:[r.map((function(e,t){return Object(j.jsxs)("tr",{children:[Object(j.jsxs)("td",{children:[Object(j.jsx)("span",{className:"badge badge-danger",children:t+1}),Object(j.jsx)("span",{className:"badge badge-info mr-2",children:e._id}),Object(j.jsx)(l.b,{to:"/letters/all?id="+e._id,children:e.code})]}),Object(j.jsx)("td",{children:e.receivedDate}),Object(j.jsx)("td",{children:e.handwritten}),Object(j.jsx)("td",{children:e.observations})]})})),0===r.length&&Object(j.jsx)("tr",{children:Object(j.jsx)("td",{children:"Nu sunt scrisori."})})]})]})]}),Object(j.jsxs)("div",{className:"col-md",children:[Object(j.jsx)("h5",{children:"Trimise"}),Object(j.jsxs)("table",{className:"table table-striped table-bordered table-hover table-sm table-responsive-md",children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Cod"}),Object(j.jsx)("th",{children:"Traseu"}),Object(j.jsx)("th",{children:"De m\xe2n\u0103?"}),Object(j.jsx)("th",{children:"Observa\u021bii"})]})}),Object(j.jsxs)("tbody",{children:[c.map((function(e,t){return Object(j.jsxs)("tr",{children:[Object(j.jsxs)("td",{children:[Object(j.jsx)("span",{className:"badge badge-danger",children:t+1}),Object(j.jsx)("span",{className:"badge badge-info mr-2",children:e._id}),Object(j.jsx)(l.b,{to:"/letters/all?id="+e._id,children:e.code})]}),Object(j.jsxs)("td",{children:[e.writtenDate&&Object(j.jsxs)(j.Fragment,{children:["Scris\u0103: ",e.writtenDate,Object(j.jsx)("br",{})]}),e.sentDate&&Object(j.jsxs)(j.Fragment,{children:["Trimis\u0103: ",e.sentDate,Object(j.jsx)("br",{})]}),e.receivedDate&&Object(j.jsxs)(j.Fragment,{children:["Primit\u0103: ",e.receivedDate,Object(j.jsx)("br",{})]})]}),Object(j.jsx)("td",{children:e.handwritten}),Object(j.jsx)("td",{children:e.observations})]})})),0===c.length&&Object(j.jsx)("tr",{children:Object(j.jsx)("td",{children:"Nu sunt scrisori."})})]})]})]})]})})]})})}))})}var R=n(78);function M(e){var t=Object(i.useState)("incoming"),n=Object(s.a)(t,2),a=n[0],r=n[1],c=Object(i.useState)(-1),l=Object(s.a)(c,2),o=l[0],d=l[1];return Object(j.jsx)(R.a,{show:e.show,onHide:e.onHide,children:Object(j.jsxs)("form",{onSubmit:function(t){t.preventDefault(),e.onSubmit(a,o)},children:[Object(j.jsx)(R.a.Header,{closeButton:!0,children:Object(j.jsx)(R.a.Title,{children:"Adaug\u0103 scrisoare nou\u0103"})}),Object(j.jsx)(R.a.Body,{children:Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"Tip scrisoare:"}),Object(j.jsxs)("select",{className:"form-control",value:a,onChange:function(e){return r(e.target.value)},children:[Object(j.jsx)("option",{value:"incoming",children:"Primit\u0103"}),Object(j.jsx)("option",{value:"outgoing",children:"Trimis\u0103"})]})]}),Object(j.jsxs)("div",{className:"form-group",children:[Object(j.jsx)("label",{children:"incoming"===a?"Expeditor:":"Destinatar:"}),Object(j.jsxs)("select",{className:"form-control",value:null!==o&&void 0!==o?o:0,onChange:function(e){return d(parseInt(e.target.value))},children:[Object(j.jsx)("option",{value:-1,disabled:!0,children:"Selecteaz\u0103..."},-1),e.destinations.map((function(e){return Object(j.jsxs)("option",{value:e._id,children:[e.name,", ",e.street," ",e.number,", ",e.locality," ",e.commune," ",e.postalCode]},e._id)}))]})]}),Object(j.jsx)("p",{children:"Acestea reprezint\u0103 datele necesare pentru crearea unei scrisori. Celelalte date pot fi ad\u0103ugate ulterior."})]})}),Object(j.jsxs)(R.a.Footer,{children:[Object(j.jsx)("button",{className:"btn btn-outline-primary",type:"button",onClick:e.onHide,children:"Anuleaz\u0103"}),Object(j.jsx)("button",{className:"btn btn-primary",type:"submit",disabled:!(-1!==o),children:"Adaug\u0103"})]})]})})}function k(e){var t,n,a,r,c,o,d,b,u,h=Object(x.i)(),O=new URLSearchParams(h.search),p=parseInt(null!==(t=O.get("p"))&&void 0!==t?t:"0"),f=O.get("id")?parseInt(null!==(n=O.get("id"))&&void 0!==n?n:"0"):null,g=Object(i.useReducer)(H,{entriesPerPage:10,isAddNewModalShown:!1,isCurrentModified:!1,isPropertyEditorHighlighted:!1}),v=Object(s.a)(g,2),N=v[0],_=v[1],S=Object(x.h)(),P=parseInt(null!==(a=O.get("d"))&&void 0!==a?a:"-1"),D="null"!==O.get("t")&&null!==(r=O.get("t"))&&void 0!==r?r:null,w=e.letters.filter((function(e){var t=!0;return null!==D&&(t=t&&e.type===D),-1!==P&&(t=t&&e.destinationId===P),t})),C=Math.floor(w.length/N.entriesPerPage)+(w.length%N.entriesPerPage!==0?1:0),A=null!==(c=w.find((function(e){return e._id===f})))&&void 0!==c?c:null;function R(e){_({type:"SET_ADD_NEW_MODAL_SHOWN",payload:e})}function k(e){var t;if(N.isCurrentModified)return _({type:"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED",payload:!0}),void setTimeout((function(){_({type:"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED",payload:!1})}),500);t=f===e?"null":e.toString(),S.push("?"+T("id",t))}function F(t){return e.destinations.find((function(e){return e._id===t}))}return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(x.a,{when:N.isCurrentModified,message:"Ave\u021bi modific\u0103ri nesalvate! Sunte\u021bi sigur c\u0103 dori\u021bi s\u0103 p\u0103r\u0103si\u021bi pagina?"}),Object(j.jsx)(M,{destinations:e.destinations,show:N.isAddNewModalShown,onHide:function(){return R(!1)},onSubmit:function(t,n){R(!1),e.onAddNew(t,n)}}),Object(j.jsxs)("div",{className:"row",children:[Object(j.jsxs)("div",{className:m()({"col-md-8":A,"col-md-12":!A}),children:[Object(j.jsxs)("div",{className:"d-flex mb-2",children:[Object(j.jsx)("div",{className:"mr-2",children:Object(j.jsx)("button",{className:"btn btn-primary",onClick:function(){return R(!0)},children:"Adaug\u0103 scrisoare"})}),Object(j.jsx)(I,{pages:C})]}),Object(j.jsxs)("div",{className:"d-flex mb-2",children:[Object(j.jsxs)("div",{className:"btn-group mr-2",children:[Object(j.jsx)("button",{className:m()({btn:!0,"btn-outline-primary":"incoming"!==D,"btn-primary":"incoming"===D}),onClick:function(){"incoming"===D?S.push("?"+T("t","null")):S.push("?"+T("t","incoming"))},children:"Numai primite"}),Object(j.jsx)("button",{className:m()({btn:!0,"btn-outline-primary":"outgoing"!==D,"btn-primary":"outgoing"===D}),onClick:function(){"outgoing"===D?S.push("?"+T("t","null")):S.push("?"+T("t","outgoing"))},children:"Numai trimise"})]}),Object(j.jsx)("div",{className:"form-group m-0",children:Object(j.jsxs)("select",{className:"form-control",value:P,onChange:function(e){S.push("?"+T("d",e.target.value))},children:[Object(j.jsx)("option",{value:-1,children:"To\u021bi destinatarii"},-1),e.destinations.filter((function(t){return e.letters.map((function(e){return e.destinationId})).includes(t._id)})).map((function(e){return Object(j.jsxs)("option",{value:e._id,children:["Numai ",e.name]},e._id)}))]})})]}),Object(j.jsxs)("table",{className:m()({"table table-bordered table-hover table-responsive-md":!0,"d-none d-md-table":A}),children:[Object(j.jsx)("thead",{children:Object(j.jsxs)("tr",{children:[Object(j.jsx)("th",{children:"Cod"}),Object(j.jsx)("th",{children:"Pentru/De la"}),Object(j.jsx)("th",{children:"Tip"}),Object(j.jsx)("th",{children:"Detalii"}),Object(j.jsx)("th",{children:"Observa\u021bii"}),!A&&Object(j.jsx)("th",{children:"Op\u021biuni"})]})}),Object(j.jsx)("tbody",{children:w.slice(N.entriesPerPage*p,N.entriesPerPage*p+N.entriesPerPage).map((function(e,t){var n,i,a,r;return Object(j.jsxs)("tr",{className:m()({"table-active":f===e._id&&!N.isCurrentModified,"table-warning":f===e._id&&N.isCurrentModified}),children:[Object(j.jsxs)("td",{style:{cursor:"pointer"},onClick:function(){return k(e._id)},children:[Object(j.jsx)("span",{className:"badge badge-danger",children:p*N.entriesPerPage+t+1}),Object(j.jsx)("span",{className:"badge badge-info",children:e._id}),"\xa0",e.code]}),Object(j.jsx)("td",{style:{cursor:"pointer"},onClick:function(){return k(e._id)},children:null===(n=F(e.destinationId))||void 0===n?void 0:n.name}),Object(j.jsx)("td",{style:{cursor:"pointer"},onClick:function(){return k(e._id)},children:"incoming"===e.type?"Primit\u0103":"Trimis\u0103"}),Object(j.jsxs)("td",{style:{cursor:"pointer"},onClick:function(){return k(e._id)},children:[e.handwritten&&Object(j.jsxs)(j.Fragment,{children:["De m\xe2n\u0103: ",e.handwritten,Object(j.jsx)("br",{})]}),"outgoing"===e.type&&Object(j.jsxs)(j.Fragment,{children:[e.writtenDate&&Object(j.jsxs)(j.Fragment,{children:["Scris\u0103: ",e.writtenDate,Object(j.jsx)("br",{})]}),e.sentDate&&Object(j.jsxs)(j.Fragment,{children:["Trimis\u0103: ",e.sentDate,Object(j.jsx)("br",{})]})]}),e.receivedDate&&Object(j.jsxs)(j.Fragment,{children:["Primit\u0103: ",e.receivedDate,Object(j.jsx)("br",{})]}),e.price&&Object(j.jsxs)(j.Fragment,{children:["Pre\u021b: ",e.price]})]}),Object(j.jsx)("td",{style:{cursor:"pointer"},onClick:function(){return k(e._id)},children:e.observations}),!A&&Object(j.jsxs)("td",{children:[Object(j.jsx)(l.b,{className:"btn btn-primary btn-sm mb-2 mr-2",to:"/letters/group?id="+(null===(i=F(e.destinationId))||void 0===i?void 0:i._id)+"#id_"+(null===(a=F(e.destinationId))||void 0===a?void 0:a._id),children:"Toate scrisorile"}),Object(j.jsx)(l.b,{className:"btn btn-primary btn-sm mb-2 mr-2",to:"/destinations?toid="+(null===(r=F(e.destinationId))||void 0===r?void 0:r._id),children:"Detalii destinatar"})]})]},e._id)}))})]}),Object(j.jsx)(I,{pages:C})]}),Object(j.jsx)("div",{className:"col",children:A&&Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("div",{className:"card mb-2 d-md-none",children:[Object(j.jsx)("div",{className:"card-header",children:Object(j.jsx)("h5",{className:"card-title",children:"Scrisoarea curent\u0103"})}),Object(j.jsxs)("div",{className:"card-body",children:["incoming"===A.type?"Expeditor":"Destinatar",":\xa0",null===(o=F(A.destinationId))||void 0===o?void 0:o.name,Object(j.jsx)("br",{}),"Tip: ","incoming"===A.type?"Primit\u0103":"Trimis\u0103",Object(j.jsx)("button",{className:"btn btn-primary btn-block",onClick:function(){S.push("?"+T("id","null"))},children:"\xcenapoi la lista scrisorilor"})]})]}),Object(j.jsxs)("div",{className:"card mb-2",children:[Object(j.jsx)("div",{className:"card-header",children:Object(j.jsx)("h5",{className:"card-title",children:"Op\u021biuni"})}),Object(j.jsxs)("div",{className:"card-body d-flex flex-column",children:[Object(j.jsx)(l.b,{className:"btn btn-primary btn-sm mb-2",to:"/letters/group?id="+(null===(d=F(A.destinationId))||void 0===d?void 0:d._id)+"#id_"+(null===(b=F(A.destinationId))||void 0===b?void 0:b._id),children:"Toate scrisorile destinatarului"}),Object(j.jsx)(l.b,{className:"btn btn-primary btn-sm mb-2",to:"/destinations?toid="+(null===(u=F(A.destinationId))||void 0===u?void 0:u._id),children:"Detalii destinatar"}),Object(j.jsx)("button",{className:"btn btn-outline-danger btn-sm",onClick:function(){A&&e.onRemove(A)},children:"\u0218terge scrisoare"})]})]}),Object(j.jsx)(E,{subject:A,onModify:function(e,t){_({type:"SET_IS_CURRENT_MODIFIED",payload:!t})},onSubmit:function(t){A&&e.onModify(t,A).then((function(){_({type:"SET_IS_CURRENT_MODIFIED",payload:!1})}))},translationTable:{code:"Cod",handwritten:"De m\xe2n\u0103",receivedDate:"Primit",price:"Pre\u021b",observations:"Observa\u021bii",writtenDate:"Scris",sentDate:"Trimis"},isHighlighted:N.isPropertyEditorHighlighted},y()(A))]})})]})]})}function H(e,t){switch(t.type){case"SET_ADD_NEW_MODAL_SHOWN":return Object(g.a)(Object(g.a)({},e),{},{isAddNewModalShown:t.payload});case"SET_IS_CURRENT_MODIFIED":return Object(g.a)(Object(g.a)({},e),{},{isCurrentModified:t.payload});case"SET_IS_PROPERTY_EDITOR_HIGHLIGHTED":return Object(g.a)(Object(g.a)({},e),{},{isPropertyEditorHighlighted:t.payload});default:throw new Error}}function F(){var e=Object(x.j)(),t=Object(i.useReducer)(U,{isLoading:!0,letters:[],destinations:[]}),n=Object(s.a)(t,2),a=n[0],r=n[1];function c(e,t){Promise.all([d.post("/letter",S({type:e,destinationId:t})),a.destinations.map((function(e){return e._id})).includes(t)?void 0:d.get("/destination/"+t).then((function(e){r({type:"PUSH_DESTINATIONS",payload:[e.data.data]})}))]).then((function(e){r({type:"PUSH_LETTERS",payload:[e[0].data.letter]})}))}function l(e,t){var n,i=e,a=new FormData,c=Object.keys(null!==t&&void 0!==t?t:{}).filter((function(n){return t[n]!==e[n]})),s=Object(v.a)(c);try{for(s.s();!(n=s.n()).done;){var l,o=n.value;a.append(o,null!==(l=e[o])&&void 0!==l?l:"")}}catch(j){s.e(j)}finally{s.f()}return a.append("_method","patch"),d.post("/letter/"+i._id,a).then((function(e){r({type:"PUSH_LETTERS",payload:[e.data.letter]})}))}function o(e){var t,n,i;window.confirm("Sunte\u021bi sigur c\u0103 dori\u021bi s\u0103 \u0219terge\u021bi scrisoarea?\nNumele: "+(null===(i=null!==(n=null===e||void 0===e?void 0:e.destinationId)&&void 0!==n?n:-1,t=a.destinations.find((function(e){return e._id===i})))||void 0===t?void 0:t.name))&&d.post("/letter/"+(null===e||void 0===e?void 0:e._id),S({_method:"delete"})).then((function(e){r({type:"REMOVE_LETTER_ID",payload:e.data.letter._id})}))}return Object(i.useEffect)((function(){Promise.all([d.get("/letters").then((function(e){var t=e.data.letters;r({type:"PUSH_LETTERS",payload:t})})),d.get("/destinations").then((function(e){var t=e.data.data;r({type:"PUSH_DESTINATIONS",payload:t.sort((function(e,t){return e.name>t.name?1:-1}))})}))]).then((function(){r({type:"SET_LOADING",payload:!1})}))}),[]),a.isLoading?Object(j.jsx)(j.Fragment,{children:Object(j.jsx)("span",{className:"spinner-border"})}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)("ul",{className:"nav nav-pills mb-2",children:[Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsx)(L,{text:"Toate",to:"".concat(e.url,"/all")})}),Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsx)(L,{text:"Grupate",to:"".concat(e.url,"/group")})})]}),Object(j.jsxs)(x.e,{children:[Object(j.jsx)(x.c,{path:e.url,exact:!0,children:Object(j.jsx)(x.b,{to:"".concat(e.url,"/all")})}),Object(j.jsx)(x.c,{path:"".concat(e.url,"/all"),children:Object(j.jsx)(k,{letters:a.letters,destinations:a.destinations,onAddNew:c,onModify:l,onRemove:o})}),Object(j.jsx)(x.c,{path:"".concat(e.url,"/group"),children:Object(j.jsx)(A,{letters:a.letters,destinations:a.destinations,onAddNew:c,onModify:l,onRemove:o})})]})]})}function L(e){var t=Object(x.j)({path:e.to,exact:e.activeOnlyWhenExact});return Object(j.jsx)(l.b,{to:e.to,className:m()({"nav-link":!0,active:t}),children:e.text})}function U(e,t){switch(t.type){case"SET_LOADING":return Object(g.a)(Object(g.a)({},e),{},{isLoading:t.payload});case"PUSH_LETTERS":var n=Object(f.a)(e.letters);return Object(f.a)(t.payload).forEach((function(t){var i=e.letters.findIndex((function(e){return e._id===t._id}));-1===i?n.push(t):n[i]=t})),n.sort((function(e,t){return-(e.timestamp!==t.timestamp?e.timestamp-t.timestamp:e._id-t._id)})),Object(g.a)(Object(g.a)({},e),{},{letters:n});case"PUSH_DESTINATIONS":var i=Object(f.a)(e.destinations);return Object(f.a)(t.payload).forEach((function(t){var n=e.destinations.findIndex((function(e){return e._id===t._id}));-1===n?i.push(t):i[n]=t})),Object(g.a)(Object(g.a)({},e),{},{destinations:i});case"REMOVE_LETTER_ID":var a=Object(f.a)(e.letters);return a=a.filter((function(e){return e._id!==t.payload})),Object(g.a)(Object(g.a)({},e),{},{letters:a});default:throw new Error}}function G(e){var t=e.label,n=e.to,i=e.activeOnlyWhenExact,a=Object(x.j)({path:n,exact:i});return Object(j.jsx)("li",{className:"nav-item",children:Object(j.jsx)(l.b,{className:m()({"nav-link":!0,active:a}),to:n,children:t})})}var z=function(e){return Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(p.a,{variant:"tabs",className:"",children:[Object(j.jsx)(p.a.Item,{children:Object(j.jsx)(G,{label:"General",to:"/general"})}),Object(j.jsx)(p.a.Item,{children:Object(j.jsx)(G,{label:"Destinatari",to:"/destinations"})}),Object(j.jsx)(p.a.Item,{children:Object(j.jsx)(G,{label:"Scrisori",to:"/letters"})})]}),Object(j.jsx)("div",{className:"border-right border-left border-bottom p-2",children:Object(j.jsxs)(x.e,{children:[Object(j.jsx)(x.c,{path:"/general",children:Object(j.jsx)(C,{onLogout:e.onLogout})}),Object(j.jsx)(x.c,{path:"/destinations",children:Object(j.jsx)(D,{})}),Object(j.jsx)(x.c,{path:"/letters",children:Object(j.jsx)(F,{})}),Object(j.jsx)(x.c,{children:Object(j.jsx)(x.b,{to:"/general"})})]})}),Object(j.jsx)("div",{className:"float-right border border-top-0 px-2 py-0 text-muted",children:Object(j.jsx)("small",{children:"Platform\u0103 de Pricop Lauren\u021biu"})})]})};var W=function(){var e=Object(i.useState)(null),t=Object(s.a)(e,2),n=t[0],a=t[1],r=Object(i.useState)(!0),c=Object(s.a)(r,2),o=c[0],u=c[1],O=Object(i.useState)(null),m=Object(s.a)(O,2),p=m[0],x=m[1],f=Object(i.useState)("login"),g=Object(s.a)(f,2),v=g[0],N=g[1],y=Object(i.useState)((function(){var e=(new Date).getHours();return!(e>=7&&e<=18)})),_=Object(s.a)(y,2),S=_[0],T=_[1];return Object(i.useEffect)((function(){d.get("/user").then((function(e){a(e.data.data),u(!1)})).catch((function(e){var t,n=null===(t=e.response)||void 0===t?void 0:t.data;!n||"access-denied"===n.status&&"not-logged-in"===n.reason?u(!1):x("Nu se poate comunica cu serverul, acesta a returnat o eroare.")}))}),[]),Object(i.useEffect)((function(){!function(){var e,t=document.getElementById("stylesheetLink");if(!t)return void alert("Nu s-a g\u0103sit elementul <link> necesar. Nu se poate continua.");var n=null!==(e=t.getAttribute("data-prefix"))&&void 0!==e?e:"";S?t.setAttribute("href",n+"/style/bootstrap.superhero.min.css"):t.setAttribute("href",n+"/style/bootstrap.united.min.css")}()}),[S]),Object(j.jsx)(l.a,{children:Object(j.jsxs)("div",{className:"container py-3 px-md-0 px-1",children:[Object(j.jsxs)("div",{className:"clearfix mb-2 mx-2 mx-md-0",children:[Object(j.jsx)("h1",{className:"d-inline",children:"Manager Po\u0219t\u0103 Fizic\u0103"}),Object(j.jsxs)("button",{className:"btn btn-outline-primary float-right btn-sm",onClick:function(){return T(!S)},children:[S&&"Mod \xeentunecat",!S&&"Mod luminos"]})]}),Object(j.jsx)("div",{className:"d-md-none alert alert-warning",children:"Folosi\u021bi un dispozitiv mobil. Aceast\u0103 aplica\u021bie web nu este (\xeenc\u0103) optimizat\u0103 pentru o experien\u021b\u0103 mobil\u0103, dar pute\u021bi continua."}),p&&Object(j.jsx)("div",{className:"alert alert-danger",children:p}),o&&Object(j.jsx)("span",{className:"spinner-border border-secondary"}),!n&&!o&&"login"===v&&Object(j.jsx)(b,{onLogin:a,onPageSwitch:function(){N("register")}}),!n&&!o&&"register"===v&&Object(j.jsx)(h,{onPageSwitch:function(){N("login")}}),n&&!o&&Object(j.jsx)(z,{user:n,onLogout:function(e){a(null)}})]})})},B=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,80)).then((function(t){var n=t.getCLS,i=t.getFID,a=t.getFCP,r=t.getLCP,c=t.getTTFB;n(e),i(e),a(e),r(e),c(e)}))};c.a.render(Object(j.jsx)(a.a.StrictMode,{children:Object(j.jsx)(W,{})}),document.getElementById("root")),B()}},[[75,1,2]]]);
//# sourceMappingURL=main.d3435381.chunk.js.map